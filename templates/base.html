<!doctype html> 
<html lang="it"> 

<head> 
  <!-- metadati di base -->
  <meta charset="utf-8"> 
  <title>{% block title %}Granda Incontri{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <meta name="author" content="Jessica Barroero">
  <meta name="description" content="Granda Incontri" />
  
  <!-- icona del sito (favicon) -->
  <link rel="icon" href="{{ url_for('static', filename='images/favicon.png') }}" type="image/png">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;500;600;700&family=Yeseva+One&display=swap" rel="stylesheet">

  <!-- fogli di stile CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet"> 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"> 
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

</head>

<body>
  <header>

    <!-- navbar principale -->
    <nav class="navbar navbar-light bg-light border-bottom px-4">
      <div class="container-fluid">

        {% if not current_user.is_authenticated %}
        <!-- layout a righe per non autenticati -->
        <div class="row w-100 align-items-center">

          <!-- titolo -->
          <div class="col-12 col-md d-flex align-items-center ps-md-3 ps-0">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo Granda Incontri" class="navbar-logo">
          </div>

          <!-- link centrati su xs, destra su md -->
          <div class="col-12 col-md d-flex justify-content-center justify-content-md-end mt-2 mt-md-0 pe-0">
            <ul class="navbar-nav flex-row">
              <li class="nav-item">
                <a href="{{ url_for('home') }}" class="nav-link px-2 {% block home_active %}{% endblock %}">Home</a>
              </li>
              <li class="nav-item">
                <a href="{{ url_for('chisiamo') }}" class="nav-link px-2 {% block signup_active %}{% endblock %}">Chi siamo</a>
              </li>
            </ul>
          </div>
        </div>

        {% else %}
        <!-- layout inline per autenticati (sempre allineato) -->
        <div class="d-flex justify-content-between align-items-center w-100">

          <!-- titolo a sinistra -->
          <div class="d-flex align-items-center ps-md-3 ps-0">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo Granda Incontri" class="navbar-logo">
          </div>

          <!-- home, hamburger a destra -->
          <div class="d-flex align-items-center">
            <a href="{{ url_for('home') }}" class="nav-link px-2 {% block home_authenticated_active %}{% endblock %}">Home</a>
            <!-- bottone per sidebar offcanvas -->
            <button class="navbar-toggler custom-toggler ms-2" type="button"
                    data-bs-toggle="offcanvas" data-bs-target="#site-sidebar"
                    aria-controls="site-sidebar" aria-label="Mostra/Nascondi menu di navigazione">
              <span class="navbar-toggler-icon custom-toggler-icon"></span>
            </button>
          </div>
        </div>
        {% endif %}
      </div>
    </nav>

    {% if current_user.is_authenticated %}
      <!-- sidebar Offcanvas per utenti autenticati -->
      <div class="offcanvas offcanvas-end bg-white" tabindex="-1" id="site-sidebar" aria-labelledby="site-sidebarLabel">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="site-sidebarLabel">Menu utente</h5>
          <button type="button" class="btn-close btn-close-sm" data-bs-dismiss="offcanvas" aria-label="Chiudi il menu utente"></button>
        </div>
        <div class="offcanvas-body">
          <ul class="nav flex-column mb-auto">
            <li>
              <a href="{{ url_for('esci') }}" class="nav-link text-dark"><i class="bi bi-box-arrow-right me-2"></i> Esci</a>
            </li>
          </ul>
        </div>
      </div>
    {% endif %}
  </header>

  <!-- messaggi flash -->
  <div id="site-alert" class="position-fixed top-0 start-50 translate-middle-x mt-3">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message | e }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Chiudi"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}
  </div>

  <!-- contenitore principale -->
  <div class="container-fluid bg-light {% block main_container_class %}{% endblock %}">
    <div class="row">
      {% block content %}
      {% endblock %}
    </div>
  </div>

  <!-- footer -->
  <footer class="bg-light text-dark border-top px-4 py-5">
    <div class="container">
      <div class="row gy-4">

        <!-- info e contatti -->
        <div class="col-12 col-sm-6 col-md-4">
          <h5>Contatti</h5>
          <ul class="nav flex-column">
            <li class="nav-item mb-2 footer-text">Email: <a href="mailto:staff@grandaincontri.com" class="text-primary custom-a">staff@grandaincontri.com</a></li>
            <li class="nav-item mb-2 footer-text">Tel: <span class="text-body-secondary">+39 391 1879136</span></li>
            <li class="nav-item mb-2 footer-text">Indirizzo: <span class="text-body-secondary">Corso Nizza, 49 - 12100 Cuneo (CN)</span></li>
          </ul>
          <div class="mt-3">
            <a href="#" class="text-dark me-3 footer-text"><i class="bi bi-instagram fs-5"></i></a>
            <a href="#" class="text-dark me-3 footer-text"><i class="bi bi-facebook fs-5"></i></a>
            <a href="#" class="text-dark me-3 footer-text"><i class="bi bi-tiktok fs-5"></i></a>
          </div>
        </div>

        <!-- policy -->
        <div class="col-12 col-sm-6 col-md-4">
          <h5>Policy</h5>
          <ul class="nav flex-column">
            <li class="nav-item mb-2 footer-text"><a href="https://www.iubenda.com/privacy-policy/7777397" class="text-primary custom-a" target="_blank"
         rel="noopener noreferrer">Privacy Policy</a></li>
          </ul>
        </div>

        <!-- link nascosto area riservata -->
        <div class="col-12">
          <ul class="nav flex-column text-center mt-3">
            <li class="nav-item">
              <a href="{{ url_for('area_riservata') }}" class="text-muted small">
                Area Riservata
              </a>
            </li>
          </ul>
        </div>


      </div>
      <div class="text-center mt-4 text-body-tertiary footer-text">
        &copy; 2024-2030 Granda Incontri - GI di R.E.- Ditta Individuale - Partita IVA 04131820047 - REA CN-338046
      </div>
    </div>
  </footer>

<!-- ─────────────────────────────────────────────────────────────
   COOKIE BANNER (bottom) + MODALE POLICY
   ───────────────────────────────────────────────────────────── -->
<div id="cookie-banner" class="cookie-banner shadow-lg" role="region" aria-label="Informativa cookie" hidden>
  <div class="container d-flex flex-column flex-md-row align-items-center gap-2 py-3">
    <div class="text-white-50 small flex-grow-1">
      Proseguendo la navigazione o chiudendo la finestra presti il tuo consenso all’utilizzo di cookie.
      <button type="button" class="btn btn-link btn-sm text-decoration-underline text-white-50 p-0 align-baseline" id="open-cookie-policy">
        Cookie policy
      </button>
    </div>
    <div class="d-flex gap-2">
      <button type="button" class="btn btn-outline-light btn-sm" id="cookie-reject">Rifiuta</button>
      <button type="button" class="btn btn-primary btn-sm" id="cookie-accept">Prosegui la navigazione</button>
    </div>
  </div>
</div>

<!-- Modal: Cookie Policy -->
<div class="modal fade" id="cookiePolicyModal" tabindex="-1" aria-labelledby="cookiePolicyLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title" id="cookiePolicyLabel">Cookie Policy di www.grandaincontri.it</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Chiudi"></button>
      </div>

      <div class="modal-body">
        <p>Questo documento contiene informazioni in merito alle tecnologie che consentono a questa Applicazione di raggiungere gli scopi descritti di seguito. Tali tecnologie permettono al Titolare di raccogliere e salvare informazioni (per esempio tramite l’utilizzo di Cookie) o di utilizzare risorse (per esempio eseguendo uno script) sul dispositivo dell’Utente quando quest’ultimo interagisce con questa Applicazione.</p>
        <p>Per semplicità, in questo documento tali tecnologie sono sinteticamente definite “Strumenti di Tracciamento”, salvo vi sia ragione di differenziare.
        Per esempio, sebbene i Cookie possano essere usati in browser sia web sia mobili, sarebbe fuori luogo parlare di Cookie nel contesto di applicazioni per dispositivi mobili, dal momento che si tratta di Strumenti di Tracciamento che richiedono la presenza di un browser. Per questo motivo, all’interno di questo documento il termine Cookie è utilizzato solo per indicare in modo specifico quel particolare tipo di Strumento di Tracciamento.</p>
        <p>Alcune delle finalità per le quali vengono impiegati Strumenti di Tracciamento potrebbero, inoltre richiedere il consenso dell’Utente. Se viene prestato il consenso, esso può essere revocato liberamente in qualsiasi momento seguendo le istruzioni contenute in questo documento.</p>
        <p>Questa Applicazione utilizza Strumenti di Tracciamento gestiti direttamente dal Titolare (comunemente detti Strumenti di Tracciamento “di prima parte”) e Strumenti di Tracciamento che abilitano servizi forniti da terzi (comunemente detti Strumenti di Tracciamento “di terza parte”). Se non diversamente specificato all’interno di questo documento, tali terzi hanno accesso ai rispettivi Strumenti di Tracciamento.
        Durata e scadenza dei Cookie e degli altri Strumenti di Tracciamento simili possono variare a seconda di quanto impostato dal Titolare o da ciascun fornitore terzo. Alcuni di essi scadono al termine della sessione di navigazione dell’Utente.
        In aggiunta a quanto specificato nella descrizione di ciascuna delle categorie di seguito riportate, gli Utenti possono ottenere informazioni più dettagliate ed aggiornate sulla durata, così come qualsiasi altra informazione rilevante - quale la presenza di altri Strumenti di Tracciamento - nelle privacy policy dei rispettivi fornitori terzi (tramite i link messi a disposizione) o contattando il Titolare.</p>

        <h6 class="policy-subtitle">Come questa Applicazione utilizza gli Strumenti di Tracciamento</h6>
        <h6 class="policy-subtitle">Necessari</h6>
        <p>Questa Applicazione utilizza Cookie comunemente detti “tecnici” o altri Strumenti di Tracciamento analoghi per svolgere attività strettamente necessarie a garantire il funzionamento o la fornitura del Servizio.</p>
        <h6 class="policy-subtitle">Misurazione</h6>
        <p>Questa Applicazione utilizza Strumenti di Tracciamento per misurare il traffico e analizzare il comportamento degli Utenti per migliorare il Servizio.</p>

        <h6 class="policy-subsubtitle">Strumenti di Tracciamento gestiti da terze parti</h6>
        <!-- ACCORDION: Google Analytics -->
        <div class="policy-accordion" id="policyAccordion">
          <div class="policy-accordion-item">
            <button class="policy-accordion-header" type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#gaItem"
                    aria-expanded="false"
                    aria-controls="gaItem">
              <span class="policy-accordion-icon" aria-hidden="true">
                <i class="bi bi-file-earmark-text"></i>
              </span>
              <span class="policy-accordion-title">
                Google Analytics (Universal Analytics) con IP anonimizzato (Google Inc.)
              </span>
              <span class="policy-accordion-caret" aria-hidden="true">
                <i class="bi bi-chevron-down"></i>
              </span>
            </button>
            <div id="gaItem" class="collapse" data-bs-parent="#policyAccordion">
              <div class="policy-accordion-body">
                <p>Google Analytics (Universal Analytics) è un servizio di analisi web fornito da Google LLC oppure da Google Ireland Limited, a seconda di come il Titolare gestisce il trattamento dei Dati, (“Google”). Google utilizza i Dati Personali raccolti allo scopo di tracciare ed esaminare l’utilizzo di questa Applicazione, compilare report e condividerli con gli altri servizi sviluppati da Google.</p>
                <p>Google potrebbe utilizzare i Dati Personali per contestualizzare e personalizzare gli annunci del proprio network pubblicitario.</p>
                <p>Questa integrazione di Google Analytics rende anonimo il tuo indirizzo IP. L'anonimizzazione funziona abbreviando entro i confini degli stati membri dell’Unione Europea o in altri Paesi aderenti all'accordo sullo Spazio Economico Europeo l'indirizzo IP degli Utenti. Solo in casi eccezionali, l'indirizzo IP sarà inviato ai server di Google ed abbreviato all'interno degli Stati Uniti. Per una comprensione dell'utilizzo dei dati da parte di Google, si prega di consultare le norme per i partner di Google.</p>

                <p class="mb-1"><strong>Dati Personali trattati:</strong> Dati di utilizzo e Strumenti di Tracciamento.</p>
                <p class="mb-1"><strong>Luogo del trattamento:</strong> USA – <a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Privacy Policy</a> – <a href="https://tools.google.com/dlpage/gaoptout" target="_blank" rel="noopener">Opt Out</a>.</p>

                <div class="policy-duration mt-3">
                  <div class="policy-duration-title">Durata degli Strumenti di Tracciamento</div>
                  <ul class="policy-duration-list">
                    <li><span>AMP_TOKEN</span><span>1 ora</span></li>
                    <li><span>_ga</span><span>2 anni</span></li>
                    <li><span>_gac*</span><span>3 mesi</span></li>
                    <li><span>_gat</span><span>1 minuto</span></li>
                    <li><span>_gid</span><span>1 giorno</span></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>

        <h6 class="policy-subtitle">Come gestire le preferenze e prestare o revocare il consenso su questa Applicazione</h6>
        <p>Qualora l’utilizzo dei Tracker sia basato sul consenso, l’Utente può fornire o revocare tale consenso impostando o aggiornando le proprie preferenze tramite il relativo pannello delle scelte in materia di privacy disponibile su questa Applicazione.</p>
        <p>Per quanto riguarda Strumenti di Tracciamento di terza parte, gli Utenti possono gestire le proprie preferenze visitando il relativo link di opt out (qualora disponibile), utilizzando gli strumenti descritti nella privacy policy della terza parte o contattando quest'ultima direttamente.</p>

        <h6 class="policy-subsubtitle">Come controllare o eliminare Cookie e tecnologie simili tramite le impostazioni del tuo dispositivo</h6>
        <p>Cancellare i Cookie o tecnologie simili dal browser.<br>
        Le impostazioni del browser, tuttavia, non consentono un controllo granulare del consenso per categoria.<br>
        Gli Utenti possono, per esempio, trovare informazioni su come gestire i Cookie in alcuni dei browser più diffusi ai seguenti indirizzi:</p>
        <ul>
          <li><a href="https://support.google.com/chrome/answer/95647" target="_blank" rel="noopener">Google Chrome</a></li>
          <li><a href="https://support.mozilla.org/it/kb/Gestione%20dei%20cookie" target="_blank" rel="noopener">Mozilla Firefox</a></li>
          <li><a href="https://support.apple.com/it-it/guide/safari/sfri11471/mac" target="_blank" rel="noopener">Apple Safari</a></li>
          <li><a href="https://support.microsoft.com/it-it/topic/eliminare-e-gestire-i-cookie-168dab11-0753-043d-7c16-ede5947fc64d" target="_blank" rel="noopener">Microsoft Internet Explorer / Edge</a></li>
          <li><a href="https://support.brave.com/hc/en-us/articles/360022806212-How-do-I-use-Shields-while-browsing" target="_blank" rel="noopener">Brave</a></li>
          <li><a href="https://help.opera.com/en/latest/web-preferences/#cookies" target="_blank" rel="noopener">Opera</a></li>
        </ul>
        <p>Gli Utenti possono inoltre gestire alcuni Strumenti di Tracciamento per applicazioni mobili disattivandoli tramite le apposite impostazioni del dispositivo, quali le impostazioni di pubblicità per dispositivi mobili o le impostazioni relative al tracciamento in generale (gli Utenti possono consultare le impostazioni del dispositivo per individuare quella pertinente).</p>

        <h6 class="policy-subsubtitle">Conseguenze legate al rifiuto dell'utilizzo di Strumenti di Tracciamento</h6>
        <p>Gli Utenti sono liberi di decidere se permettere o meno l'utilizzo di Strumenti di Tracciamento. Tuttavia, si noti che gli Strumenti di Tracciamento consentono a questa Applicazione di fornire agli Utenti un'esperienza migliore e funzionalità avanzate (in linea con le finalità delineate nel presente documento). Pertanto, qualora l'Utente decida di bloccare l'utilizzo di Strumenti di Tracciamento, il Titolare potrebbe non essere in grado di fornire le relative funzionalità.</p>

        <h6 class="policy-subtitle">Titolare del Trattamento dei Dati</h6>
        <p class="org-name"><strong>Granda Incontri - GI di R.E.</strong></p>
        <ul>
          <li>Partita IVA: 04131820047</li>
          <li>Numero REA: CN-338046</li>
          <li>Email: <a href="mailto:staff@grandaincontri.com">staff@grandaincontri.com</a></li>
        </ul>
        <p>Dal momento che l’uso di Strumenti di Tracciamento di terza parte su questa Applicazione non può essere completamente controllato dal Titolare, ogni riferimento specifico a Strumenti di Tracciamento di terza parte è da considerarsi indicativo. Per ottenere informazioni complete, gli Utenti sono gentilmente invitati a consultare la privacy policy dei rispettivi servizi terzi elencati in questo documento.</p>
        <p>Data l'oggettiva complessità di identificazione delle tecnologie di tracciamento, gli Utenti sono invitati a contattare il Titolare qualora volessero ricevere ulteriori informazioni in merito all'utilizzo di tali tecnologie su questa Applicazione.</p>

        <!-- Definizioni e riferimenti legali (SOTTO TUTTO) -->
        <div class="policy-dashed">
          <div class="policy-accordion mt-2" id="definitionsAccordion">
            <div class="policy-accordion-item">
              <button class="policy-accordion-header" type="button"
                      data-bs-toggle="collapse"
                      data-bs-target="#definitionsItem"
                      aria-expanded="false"
                      aria-controls="definitionsItem">
                <span class="policy-accordion-icon" aria-hidden="true">
                  <i class="bi bi-bookmark"></i>
                </span>
                <span class="policy-accordion-title">Definizioni e riferimenti legali</span>
                <span class="policy-accordion-caret" aria-hidden="true">
                  <i class="bi bi-chevron-down"></i>
                </span>
              </button>
              <div id="definitionsItem" class="collapse" data-bs-parent="#definitionsAccordion">
                <div class="policy-accordion-body">
                  <h6 class="policy-subsubtitle">Dati Personali (o Dati)</h6>
                  <p>Costituisce dato personale qualunque informazione che, direttamente o indirettamente, anche in collegamento con qualsiasi altra informazione, ivi compreso un numero di identificazione personale, renda identificata o identificabile una persona fisica.</p>

                  <h6 class="policy-subsubtitle">Dati di Utilizzo</h6>
                  <p>Sono le informazioni raccolte automaticamente attraverso questa Applicazione (anche da applicazioni di parti terze integrate in questa Applicazione), tra cui: gli indirizzi IP o i nomi a dominio dei computer utilizzati dall’Utente che si connette con questa Applicazione, gli indirizzi in notazione URI (Uniform Resource Identifier), l’orario della richiesta, il metodo utilizzato nell’inoltrare la richiesta al server, la dimensione del file ottenuto in risposta, il codice numerico indicante lo stato della risposta dal server (buon fine, errore, ecc.) il paese di provenienza, le caratteristiche del browser e del sistema operativo utilizzati dal visitatore, le varie connotazioni temporali della visita (ad esempio il tempo di permanenza su ciascuna pagina) e i dettagli relativi all’itinerario seguito all’interno dell’Applicazione, con particolare riferimento alla sequenza delle pagine consultate, ai parametri relativi al sistema operativo e all’ambiente informatico dell’Utente.</p>

                  <h6 class="policy-subsubtitle">Utente</h6>
                  <p>L'individuo che utilizza questa Applicazione che, salvo ove diversamente specificato, coincide con l'Interessato.</p>

                  <h6 class="policy-subsubtitle">Interessato</h6>
                  <p>La persona fisica cui si riferiscono i Dati Personali.</p>

                  <h6 class="policy-subsubtitle">Responsabile del Trattamento (o Responsabile)</h6>
                  <p>La persona fisica, giuridica, la pubblica amministrazione e qualsiasi altro ente che tratta dati personali per conto del Titolare, secondo quanto esposto nella presente privacy policy.</p>

                  <h6 class="policy-subsubtitle">Titolare del Trattamento (o Titolare)</h6>
                  <p>La persona fisica o giuridica, l'autorità pubblica, il servizio o altro organismo che, singolarmente o insieme ad altri, determina le finalità e i mezzi del trattamento di dati personali e gli strumenti adottati, ivi comprese le misure di sicurezza relative al funzionamento ed alla fruizione di questa Applicazione. Il Titolare del Trattamento, salvo quanto diversamente specificato, è il titolare di questa Applicazione.</p>

                  <h6 class="policy-subsubtitle">Questa Applicazione</h6>
                  <p>Lo strumento hardware o software mediante il quale sono raccolti e trattati i Dati Personali degli Utenti.</p>

                  <h6 class="policy-subsubtitle">Servizio</h6>
                  <p>Il Servizio fornito da questa Applicazione così come definito nei relativi termini (se presenti) su questo sito/applicazione.</p>

                  <h6 class="policy-subsubtitle">Unione Europea (o UE)</h6>
                  <p>Salvo ove diversamente specificato, ogni riferimento all’Unione Europea contenuto in questo documento si intende esteso a tutti gli attuali stati membri dell’Unione Europea e dello Spazio Economico Europeo.</p>

                  <h6 class="policy-subsubtitle">Cookie</h6>
                  <p>I Cookie sono Strumenti di Tracciamento che consistono in piccole porzioni di dati conservate all'interno del browser dell’Utente.</p>

                  <h6 class="policy-subsubtitle">Strumento di Tracciamento</h6>
                  <p>Per Strumento di Tracciamento s’intende qualsiasi tecnologia - es. Cookie, identificativi univoci, web beacons, script integrati, e-tag e fingerprinting - che consenta di tracciare gli Utenti, per esempio raccogliendo o salvando informazioni sul dispositivo dell’Utente.</p>

                  <hr class="policy-sep">
                  <h6 class="policy-subsubtitle">Riferimenti legali</h6>
                  <p>Ove non diversamente specificato, questa informativa privacy riguarda esclusivamente questa Applicazione.</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <p class="text-muted small mb-0 mt-2">Ultima modifica: 24 settembre 2024</p>
        <p class="text-muted small mb-0">
          <a href="https://www.iubenda.com/it/cookie-solution" target="_blank" rel="noopener">iubenda</a> ospita questo contenuto e raccoglie solo i
          <a href="https://www.iubenda.com/privacy-policy/19418041" target="_blank" rel="noopener">Dati Personali strettamente necessari</a>
          alla sua fornitura.
        </p>
        <p class="small">Visualizza la <a href="https://www.iubenda.com/privacy-policy/7777397" target="_blank" rel="noopener">Privacy Policy</a> Completa</p>
      </div> <!-- /modal-body -->

      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Chiudi</button>
      </div>

    </div>
  </div>
</div>

<!-- Bootstrap bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"></script>

<!-- Script unico: alert/tooltip, cookie banner + modale, caret accordion -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  /* ── Bootstrap: alert + tooltip ─────────────────────────────── */
  const alertList = document.querySelectorAll(".alert");
  [...alertList].forEach(el => new bootstrap.Alert(el));

  const tooltipTriggerList = document.querySelectorAll("[data-bs-toggle='tooltip']");
  [...tooltipTriggerList].forEach(el => new bootstrap.Tooltip(el));

  // chiusura automatica dei messaggi flash
  const flashes = document.querySelectorAll("#site-alert .alert");
  flashes.forEach(el => {
    setTimeout(() => bootstrap.Alert.getOrCreateInstance(el).close(), 4000);
  });

  /* ── Cookie banner + modale policy ───────────────────────────── */
const LS_KEY  = "gi_cookie_consent"; // 'accepted' | 'rejected'
const banner  = document.getElementById("cookie-banner");
const btnAccept = document.getElementById("cookie-accept");
const btnReject = document.getElementById("cookie-reject");
const btnOpen   = document.getElementById("open-cookie-policy");
const modalEl   = document.getElementById("cookiePolicyModal");
const modal     = modalEl ? new bootstrap.Modal(modalEl) : null;

// mostra il banner se non c'è una scelta
try {
  const choice = localStorage.getItem(LS_KEY);
  if (!choice && banner) {
    banner.hidden = false;
    document.body.classList.add("cookie-banner-visible");
  }
} catch (e) {
  if (banner) {
    banner.hidden = false;
    document.body.classList.add("cookie-banner-visible");
  }
}

// azioni banner
btnAccept?.addEventListener("click", () => {
  try { localStorage.setItem(LS_KEY, "accepted"); } catch {}
  if (banner) banner.hidden = true;
  document.body.classList.remove("cookie-banner-visible"); // libera spazio alla modale
  // qui potresti inizializzare tool non essenziali (es. Analytics)
});

btnReject?.addEventListener("click", () => {
  try { localStorage.setItem(LS_KEY, "rejected"); } catch {}
  if (banner) banner.hidden = true;
  document.body.classList.remove("cookie-banner-visible"); // libera spazio alla modale
  // opzionale: spegnere script di tracking non essenziali
});

// apri modale policy dal link nel banner
btnOpen?.addEventListener("click", () => { modal?.show(); });

/* ── Accordion: ruota la caret quando apre/chiude ────────────── */
document.addEventListener("shown.bs.collapse", function (e) {
  const header = e.target.previousElementSibling; // <button> dell'accordion
  header?.querySelector(".policy-accordion-caret .bi")?.classList.add("rotate-180");
});
document.addEventListener("hidden.bs.collapse", function (e) {
  const header = e.target.previousElementSibling;
  header?.querySelector(".policy-accordion-caret .bi")?.classList.remove("rotate-180");
});
});
</script>

</body>
</html>

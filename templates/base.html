<!doctype html> 
<html lang="it"> 

<head> 
  <!-- metadati di base -->
  <meta charset="utf-8"> 
  <title>{% block title %}Granda Incontri{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <meta name="author" content="Jessica Barroero">
  <meta name="description" content="Granda Incontri" />
  
  <!-- icona del sito (favicon) -->
  <link rel="icon" href="{{ url_for('static', filename='images/favicon.png') }}" type="image/png">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;500;600;700&family=Yeseva+One&display=swap" rel="stylesheet">

  <!-- fogli di stile CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet"> 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"> 
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

</head>

<body>
  <header>

    <!-- navbar principale -->
    <nav class="navbar navbar-light bg-light border-bottom px-4">
      <div class="container-fluid">

        {% if not current_user.is_authenticated %}
        <!-- layout a righe per non autenticati -->
        <div class="row w-100 align-items-center">

          <!-- titolo -->
          <div class="col-12 col-md d-flex align-items-center ps-md-3 ps-0">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo Granda Incontri" class="navbar-logo">
          </div>

          <!-- link centrati su xs, destra su md -->
          <div class="col-12 col-md d-flex justify-content-center justify-content-md-end mt-2 mt-md-0 pe-0">
            <ul class="navbar-nav flex-row">
              <li class="nav-item">
                <a href="{{ url_for('home') }}" class="nav-link px-2 {% block home_active %}{% endblock %}">Home</a>
              </li>
              <li class="nav-item">
                <a href="{{ url_for('chisiamo') }}" class="nav-link px-2 {% block signup_active %}{% endblock %}">Chi siamo</a>
              </li>
            </ul>
          </div>
        </div>

        {% else %}
        <!-- layout inline per autenticati (sempre allineato) -->
        <div class="d-flex justify-content-between align-items-center w-100">

          <!-- titolo a sinistra -->
          <div class="d-flex align-items-center ps-md-3 ps-0">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo Granda Incontri" class="navbar-logo">
          </div>

          <!-- home, hamburger a destra -->
          <div class="d-flex align-items-center">
            <a href="{{ url_for('home') }}" class="nav-link px-2 {% block home_authenticated_active %}{% endblock %}">Home</a>
            <!-- bottone per sidebar offcanvas -->
            <button class="navbar-toggler custom-toggler ms-2" type="button"
                    data-bs-toggle="offcanvas" data-bs-target="#site-sidebar"
                    aria-controls="site-sidebar" aria-label="Mostra/Nascondi menu di navigazione">
              <span class="navbar-toggler-icon custom-toggler-icon"></span>
            </button>
          </div>
        </div>
        {% endif %}
      </div>
    </nav>

    {% if current_user.is_authenticated %}
      <!-- sidebar Offcanvas per utenti autenticati -->
      <div class="offcanvas offcanvas-end bg-white" tabindex="-1" id="site-sidebar" aria-labelledby="site-sidebarLabel">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="site-sidebarLabel">Menu utente</h5>
          <button type="button" class="btn-close btn-close-sm" data-bs-dismiss="offcanvas" aria-label="Chiudi il menu utente"></button>
        </div>
        <div class="offcanvas-body">
          <ul class="nav flex-column mb-auto">
            <li>
              <a href="{{ url_for('esci') }}" class="nav-link text-dark"><i class="bi bi-box-arrow-right me-2"></i> Esci</a>
            </li>
          </ul>
        </div>
      </div>
    {% endif %}
  </header>

  <!-- messaggi flash -->
  <div id="site-alert" class="position-fixed top-0 start-50 translate-middle-x mt-3">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message | e }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Chiudi"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}
  </div>

  <!-- contenitore principale -->
  <div class="container-fluid bg-light {% block main_container_class %}{% endblock %}">
    <div class="row">
      {% block content %}
      {% endblock %}
    </div>
  </div>

  <!-- footer -->
  <footer class="bg-light text-dark border-top px-4 py-5">
    <div class="container">
      <div class="row gy-4">

        <!-- info e contatti -->
        <div class="col-12 col-sm-6 col-md-4">
          <h5>Contatti</h5>
          <ul class="nav flex-column">
            <li class="nav-item mb-2 footer-text">Email: <a href="mailto:staff@grandaincontri.com" class="text-primary custom-a">staff@grandaincontri.com</a></li>
            <li class="nav-item mb-2 footer-text">Tel: <span class="text-body-secondary">+39 391 1879136</span></li>
            <li class="nav-item mb-2 footer-text">Indirizzo: <span class="text-body-secondary">Corso Nizza, 49 - 12100 Cuneo (CN)</span></li>
          </ul>
          <div class="mt-3">
            <a href="#" class="text-dark me-3 footer-text"><i class="bi bi-instagram fs-5"></i></a>
            <a href="#" class="text-dark me-3 footer-text"><i class="bi bi-facebook fs-5"></i></a>
            <a href="#" class="text-dark me-3 footer-text"><i class="bi bi-tiktok fs-5"></i></a>
          </div>
        </div>

        <!-- policy -->
        <div class="col-12 col-sm-6 col-md-4">
          <h5>Policy</h5>
          <ul class="nav flex-column">
            <li class="nav-item mb-2 footer-text"><a href="https://www.iubenda.com/privacy-policy/7777397" class="text-primary custom-a" target="_blank"
         rel="noopener noreferrer">Privacy Policy</a></li>
          </ul>
        </div>

        <!-- link nascosto area riservata -->
        <div class="col-12">
          <ul class="nav flex-column text-center mt-3">
            <li class="nav-item">
              <a href="{{ url_for('accedi') }}" class="text-muted small">
                Area Riservata
              </a>
            </li>
          </ul>
        </div>


      </div>
      <div class="text-center mt-4 text-body-tertiary footer-text">
        &copy; 2024-2030 Granda Incontri - GI di R.E.- Ditta Individuale - Partita IVA 04131820047 - REA CN-338046
      </div>
    </div>
  </footer>

  <!-- script Bootstrap e logica client -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // inizializzazione tooltip Bootstrap
      const alertList = document.querySelectorAll('.alert')
      const alerts = [...alertList].map(element => new bootstrap.Alert(element))

      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))

      // chiusura automatica dei messaggi flash
      const flashMessages = document.querySelectorAll("#site-alert .alert");
      flashMessages.forEach(function(alert) {
        setTimeout(function () {
          let alertInstance = bootstrap.Alert.getOrCreateInstance(alert);
          alertInstance.close();
        }, 4000);
      });
    });
  </script>
</body>
</html>
